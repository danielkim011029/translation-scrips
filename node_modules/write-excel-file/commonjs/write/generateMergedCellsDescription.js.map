{"version":3,"file":"generateMergedCellsDescription.js","names":["generateMergedCellsDescription","data","schema","mergedCells","rowIndex","length","row","columnIndex","span","rowSpan","rowNumber","push","generateCellNumber","map","coordinates","join"],"sources":["../../source/write/generateMergedCellsDescription.js"],"sourcesContent":["import generateCellNumber from './generateCellNumber.js'\r\n\r\n// Supports \"merging cells\" across columns and rows.\r\n// https://rdrr.io/cran/openxlsx/man/mergeCells.html\r\n//\r\n// XML example:\r\n// `<sheetData>...</sheetData><mergeCells count=\"1\"><mergeCell ref=\"A2:C3\"/></mergeCells>`\r\n//\r\n// Configuration example:\r\n//\r\n// rows:\r\n// [\r\n//   [...],\r\n//   [\r\n//     { type: String, value: 'abc', span: 3, rowSpan: 2 },\r\n//     { ... },\r\n//     { ... }\r\n//   ],\r\n//   [...],\r\n// ]\r\n\r\nexport default function generateMergedCellsDescription(data, { schema }) {\r\n\tif (schema) {\r\n\t\treturn ''\r\n\t}\r\n\tconst mergedCells = []\r\n\tlet rowIndex = 0\r\n\twhile (rowIndex < data.length) {\r\n\t\tconst row = data[rowIndex]\r\n\t\tlet columnIndex = 0\r\n\t\twhile (columnIndex < row.length) {\r\n\t\t\tconst { span, rowSpan } = row[columnIndex]\r\n\t\t\tif (span || rowSpan) {\r\n\t\t\t\tconst rowNumber = rowIndex + 1\r\n\t\t\t\tmergedCells.push(\r\n\t\t\t\t\tgenerateCellNumber(columnIndex, rowNumber) +\r\n\t\t\t\t\t':' +\r\n\t\t\t\t\tgenerateCellNumber(\r\n\t\t\t\t\t\tcolumnIndex + (span ? span - 1 : 0),\r\n\t\t\t\t\t\trowNumber + (rowSpan ? rowSpan - 1 : 0)\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\tcolumnIndex++\r\n\t\t}\r\n\t\trowIndex++\r\n\t}\r\n\tif (mergedCells.length === 0) {\r\n\t\treturn ''\r\n\t}\r\n\treturn `<mergeCells count=\"${mergedCells.length}\">` +\r\n\t\tmergedCells.map(coordinates => `<mergeCell ref=\"${coordinates}\"/>`).join('') +\r\n\t\t'</mergeCells>'\r\n}"],"mappings":";;;;;;;AAAA;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEe,SAASA,8BAAT,CAAwCC,IAAxC,QAA0D;EAAA,IAAVC,MAAU,QAAVA,MAAU;;EACxE,IAAIA,MAAJ,EAAY;IACX,OAAO,EAAP;EACA;;EACD,IAAMC,WAAW,GAAG,EAApB;EACA,IAAIC,QAAQ,GAAG,CAAf;;EACA,OAAOA,QAAQ,GAAGH,IAAI,CAACI,MAAvB,EAA+B;IAC9B,IAAMC,GAAG,GAAGL,IAAI,CAACG,QAAD,CAAhB;IACA,IAAIG,WAAW,GAAG,CAAlB;;IACA,OAAOA,WAAW,GAAGD,GAAG,CAACD,MAAzB,EAAiC;MAChC,uBAA0BC,GAAG,CAACC,WAAD,CAA7B;MAAA,IAAQC,IAAR,oBAAQA,IAAR;MAAA,IAAcC,OAAd,oBAAcA,OAAd;;MACA,IAAID,IAAI,IAAIC,OAAZ,EAAqB;QACpB,IAAMC,SAAS,GAAGN,QAAQ,GAAG,CAA7B;QACAD,WAAW,CAACQ,IAAZ,CACC,IAAAC,8BAAA,EAAmBL,WAAnB,EAAgCG,SAAhC,IACA,GADA,GAEA,IAAAE,8BAAA,EACCL,WAAW,IAAIC,IAAI,GAAGA,IAAI,GAAG,CAAV,GAAc,CAAtB,CADZ,EAECE,SAAS,IAAID,OAAO,GAAGA,OAAO,GAAG,CAAb,GAAiB,CAA5B,CAFV,CAHD;MAQA;;MACDF,WAAW;IACX;;IACDH,QAAQ;EACR;;EACD,IAAID,WAAW,CAACE,MAAZ,KAAuB,CAA3B,EAA8B;IAC7B,OAAO,EAAP;EACA;;EACD,OAAO,8BAAsBF,WAAW,CAACE,MAAlC,WACNF,WAAW,CAACU,GAAZ,CAAgB,UAAAC,WAAW;IAAA,kCAAuBA,WAAvB;EAAA,CAA3B,EAAoEC,IAApE,CAAyE,EAAzE,CADM,GAEN,eAFD;AAGA"}